(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-74afe032"],{"8840d":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[this.loading?n("a-spin"):t._e(),n("a-row",{attrs:{gutter:24,type:"flex"}},[n("a-col",{staticClass:"mb-24",attrs:{span:24}},[n("CardAuthorTable",{attrs:{data:t.table1Data,columns:t.table1Columns,"row-key":function(t){return t.key},loading:t.loading},on:{onChangeUserStatus:t.changeUserStatus,onDelete:t.onDeleteInUsers,sortTableByRole:t.sortTableByRole,onSearch:t.searchInUsers}})],1)],1),n("a-row",{attrs:{gutter:24,type:"flex"}},[n("a-col",{staticClass:"mb-24",attrs:{span:24}},[n("CardCategoriesTable")],1)],1)],1)},s=[],i=function(){var t=this,e=this,n=e.$createElement,a=e._self._c||n;return a("a-card",{staticClass:"header-solid h-full",attrs:{bordered:!1,bodyStyle:{padding:0}},scopedSlots:e._u([{key:"title",fn:function(){return[a("a-row",{attrs:{type:"flex",align:"middle"}},[a("a-col",{attrs:{span:24,md:12}},[a("h5",{staticClass:"font-semibold m-0"},[e._v("Пользователи")])]),a("a-col",{staticStyle:{display:"flex","align-items":"center","justify-content":"flex-end"},attrs:{span:24,md:12}},[a("a-radio-group",{attrs:{size:"small"},model:{value:e.authorsHeaderBtns,callback:function(t){e.authorsHeaderBtns=t},expression:"authorsHeaderBtns"}},[a("a-radio-button",{on:{click:function(t){return e.sortTableByRole("all")}}},[e._v("Все")]),a("a-radio-button",{on:{click:function(t){return e.sortTableByRole("user")}}},[e._v("Физ. лица")]),a("a-radio-button",{on:{click:function(t){return e.sortTableByRole("company")}}},[e._v("Юр. лица")])],1)],1),a("a-input-search",{staticClass:"header-search mt-15",class:e.searchLoading?"loading":"",attrs:{placeholder:"Введите Email / ФИО / Дату регистрации (yy-mm-dd)"},on:{input:e.onSearch,search:e.onSearch},model:{value:e.searchText,callback:function(t){e.searchText=t},expression:"searchText"}})],1)]},proxy:!0}])},[e.editModalWindow.visible?a("show-edit-user",{attrs:{index:e.editModalWindow.key,visible:e.editModalWindow.visible},on:{modalClose:function(){return t.editModalWindow.visible=!1}}}):e._e(),e.data.length?a("a-table",{attrs:{columns:e.columns,"data-source":e.data,pagination:!0},scopedSlots:e._u([{key:"author",fn:function(t){return[a("div",{staticClass:"table-avatar-info"},[a("div",{staticClass:"avatar-info"},[a("h6",[e._v(e._s(t.name))]),a("p",[e._v(e._s(t.email))])])])]}},{key:"func",fn:function(t){return[a("div",{staticClass:"author-info"},[a("h6",{staticClass:"m -0"},[e._v(e._s(t.job))]),a("p",{staticClass:"m-0 font-regular text-muted"},[e._v(e._s(t.department))])])]}},{key:"status",fn:function(t){return[a("a-tag",{staticClass:"tag-status",class:t?"ant-tag-primary":"ant-tag-muted"},[e._v(" "+e._s(t?"ПОДТВЕРЖДЕН":"НЕ ПОДТВЕРЖДЕН")+" ")])]}},{key:"editBtn",fn:function(t){return[a("a-button",{staticClass:"btn",attrs:{type:"link",size:"small"},on:{click:function(n){return e.showDeleteConfirm(t)}}},[a("svg",{attrs:{width:"16",height:"16",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[a("path",{staticClass:"fill-danger",attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M9 2C8.62123 2 8.27497 2.214 8.10557 2.55279L7.38197 4H4C3.44772 4 3 4.44772 3 5C3 5.55228 3.44772 6 4 6L4 16C4 17.1046 4.89543 18 6 18H14C15.1046 18 16 17.1046 16 16V6C16.5523 6 17 5.55228 17 5C17 4.44772 16.5523 4 16 4H12.618L11.8944 2.55279C11.725 2.214 11.3788 2 11 2H9ZM7 8C7 7.44772 7.44772 7 8 7C8.55228 7 9 7.44772 9 8V14C9 14.5523 8.55228 15 8 15C7.44772 15 7 14.5523 7 14V8ZM12 7C11.4477 7 11 7.44772 11 8V14C11 14.5523 11.4477 15 12 15C12.5523 15 13 14.5523 13 14V8C13 7.44772 12.5523 7 12 7Z",fill:"#111827"}})]),a("span",{staticClass:"text-danger"},[e._v("УДАЛИТЬ")])]),a("a-button",{attrs:{type:"link",size:"small"},on:{click:function(n){return e.showEditConfirm(t)}}},[a("a-icon",{attrs:{type:"mail"}}),a("span",{staticClass:"text-dark"},[e._v("ОТПРАВИТЬ ПИСЬМО")])],1),a("a-button",{attrs:{type:"link",size:"small"},on:{click:function(n){return e.changeStatus(t)}}},[a("svg",{attrs:{width:"16",height:"16",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[a("path",{staticClass:"fill-muted",attrs:{d:"M13.5858 3.58579C14.3668 2.80474 15.6332 2.80474 16.4142 3.58579C17.1953 4.36683 17.1953 5.63316 16.4142 6.41421L15.6213 7.20711L12.7929 4.37868L13.5858 3.58579Z",fill:"#111827"}}),a("path",{staticClass:"fill-muted",attrs:{d:"M11.3787 5.79289L3 14.1716V17H5.82842L14.2071 8.62132L11.3787 5.79289Z",fill:"#111827"}})]),a("span",{staticClass:"text-dark"},[e._v("ИЗМЕНИТЬ СТАТУС")])])]}},{key:"expandedRowRender",fn:function(t){return a("p",{staticStyle:{margin:"0"},domProps:{innerHTML:e._s(t.description)}})}}],null,!1,588761751)}):e._e()],1)},o=[],r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("a-modal",{attrs:{title:"Отправить письмо на: "+this.user.email,visible:t.visible,"confirm-loading":t.confirmLoading},on:{ok:t.handleOk,cancel:t.handleCancel}},[n("br"),n("b",[t._v("Текст письма "),n("a-textarea",{staticClass:"mb-15",attrs:{placeholder:"Электронная почта"},model:{value:t.message,callback:function(e){t.message=e},expression:"message"}})],1)])],1)},l=[],c={name:"show-edit-user",data:function(){return{ModalText:"Content of the modal",confirmLoading:!1,message:""}},computed:{user:function(){return this.$store.getters.getUserByKey(this.index)},loading:function(){return this.$store.getters.loading}},props:{visible:!1,index:null},methods:{handleOk:function(){this.ModalText="The modal will be closed after two seconds",this.confirmLoading=!0,this.$store.dispatch("sendEmailToUser",{index:this.user.id,message:this.message});var t=this.$message.loading("Отправляю письмо...",0);setTimeout(t,2500),this.$emit("modalClose")},handleCancel:function(){this.$emit("modalClose")}}},u=c,d=n("2877"),m=Object(d["a"])(u,r,l,!1,null,null,null),h=m.exports,p={name:"App",components:{ShowEditUser:h},data:function(){return{authorsHeaderBtns:"all",isModalVisible:!1,editModalWindow:{visible:!1,key:1},searchText:""}},methods:{sortTableByRole:function(t){this.$emit("sortTableByRole",t)},changeStatus:function(t){var e=this,n=t.key;this.$confirm({title:"Изменить статус",content:"ВЫ УВЕРЕНЫ?",okText:"Да",cancelText:"Нет",onOk:function(){e.$emit("onChangeUserStatus",n)}})},showDeleteConfirm:function(t){var e=this,n=t.key;this.$confirm({title:"ПРЕДУПРЕЖДЕНИЕ",width:500,content:"Вы действительно хотите удалить данного пользователя?",okText:"Да",okType:"danger",cancelText:"Нет",onOk:function(){e.$emit("onDelete",n)},onCancel:function(){console.log("Cancel")}})},showEditConfirm:function(t){this.editModalWindow.visible=!0,this.editModalWindow.key=t.key},searchLoading:function(){},onSearch:function(){var t=this.searchText;t?this.$emit("onSearch",t):this.$emit("sortTableByRole","all")}},props:{data:{type:Array,default:function(){return[]}},columns:{type:Array,default:function(){return[]}}}},f=p,g=Object(d["a"])(f,i,o,!1,null,null,null),v=g.exports,w=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("a-card",{staticClass:"header-solid h-full",attrs:{bordered:!1,bodyStyle:{padding:0}},scopedSlots:t._u([{key:"title",fn:function(){return[n("a-row",{attrs:{type:"flex",align:"middle"}},[n("a-col",{attrs:{span:24,md:12}},[n("h5",{staticClass:"font-semibold m-0"},[t._v("Категории")])])],1)]},proxy:!0}])},[t.isEditAction?n("EditRowModal",{attrs:{visible:t.isEditAction,row:t.curRow},on:{onClose:function(){return t.isEditAction=!1}}}):t._e(),t.isCreateAction?n("CreateSearchArgument",{attrs:{visible:t.isCreateAction,row:t.curRow},on:{onClose:function(){return t.isCreateAction=!1}}}):t._e(),t.data.length?n("a-table",{attrs:{columns:t.columns,"data-source":t.data,pagination:!0},scopedSlots:t._u([{key:"category.id",fn:function(e){return[n("span",{domProps:{innerHTML:t._s(e.idTitle)}})]}},{key:"category.name",fn:function(e){return[n("h6",{staticClass:"m-0"},[t._v(" "+t._s(e.name+(e.gradation?e.gradation:""))+" ")])]}},{key:"category.type",fn:function(e){return[n("h6",{staticClass:"m-0"},[t._v(" "+t._s(e.type)+" ")]),"searchArgument"===e.is?n("div",{domProps:{innerHTML:t._s(e.description)}}):t._e()]}},{key:"category.count",fn:function(e){return["searchArgument"!==e.is?n("h6",[t._v(" "+t._s(e.productsCount)+" ")]):t._e()]}},{key:"category.edit",fn:function(e){return[n("a-button",{staticClass:"btn",attrs:{type:"link",size:"small"},on:{click:function(n){return t.deleteRow(e)}}},[n("svg",{attrs:{width:"16",height:"16",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[n("path",{staticClass:"fill-danger",attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M9 2C8.62123 2 8.27497 2.214 8.10557 2.55279L7.38197 4H4C3.44772 4 3 4.44772 3 5C3 5.55228 3.44772 6 4 6L4 16C4 17.1046 4.89543 18 6 18H14C15.1046 18 16 17.1046 16 16V6C16.5523 6 17 5.55228 17 5C17 4.44772 16.5523 4 16 4H12.618L11.8944 2.55279C11.725 2.214 11.3788 2 11 2H9ZM7 8C7 7.44772 7.44772 7 8 7C8.55228 7 9 7.44772 9 8V14C9 14.5523 8.55228 15 8 15C7.44772 15 7 14.5523 7 14V8ZM12 7C11.4477 7 11 7.44772 11 8V14C11 14.5523 11.4477 15 12 15C12.5523 15 13 14.5523 13 14V8C13 7.44772 12.5523 7 12 7Z",fill:"#111827"}})]),n("span",{staticClass:"text-danger"},[t._v("УДАЛИТЬ")])]),n("a-button",{attrs:{type:"link",size:"small"},on:{click:function(n){return t.editRow(e)}}},[n("svg",{attrs:{width:"16",height:"16",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[n("path",{staticClass:"fill-muted",attrs:{d:"M13.5858 3.58579C14.3668 2.80474 15.6332 2.80474 16.4142 3.58579C17.1953 4.36683 17.1953 5.63316 16.4142 6.41421L15.6213 7.20711L12.7929 4.37868L13.5858 3.58579Z",fill:"#111827"}}),n("path",{staticClass:"fill-muted",attrs:{d:"M11.3787 5.79289L3 14.1716V17H5.82842L14.2071 8.62132L11.3787 5.79289Z",fill:"#111827"}})]),n("span",{staticClass:"text-dark"},[t._v("РЕДАКТИРОВАТЬ")])]),"property"===e.is?n("a-button",{attrs:{type:"link",size:"small"},on:{click:function(n){return t.addArgument(e)}}},[n("a-icon",{attrs:{type:"plus"}}),n("span",{staticClass:"text-dark"},[t._v("ДОБАВИТЬ")])],1):t._e()]}}],null,!1,1109628987)}):t._e(),n("UploadFile")],1)},y=[],C=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("a-modal",{attrs:{title:"Редактируется: "+this.row.type,visible:t.visible},on:{ok:t.handleOk,cancel:function(e){return t.$emit("onClose")}}},[n("br"),n("div",[n("a-input",{model:{value:t.newName,callback:function(e){t.newName=e},expression:"newName"}})],1),"category"===t.row.is?n("div",[n("a-input",{model:{value:t.newGradationName,callback:function(e){t.newGradationName=e},expression:"newGradationName"}})],1):t._e()])],1)},b=[],_=(n("b0c0"),{data:function(){return{newName:"",prop:"",newGradationName:""}},props:{row:{},visible:{}},methods:{handleOk:function(){var t={};t="category"===this.row.is?{name:this.newName,gradation_name:this.newGradationName}:{name:this.newName},console.log(t);var e=this.$message.loading("Меняю значение...",0);setTimeout(e,2500),this.$store.dispatch("editCategory",{id:this.row.id,type:this.row.is,data:t}),this.$emit("onClose")},handleCancel:function(){this.$emit("onClose")}},mounted:function(){this.newName=this.row.name,"category"===this.row.is&&(this.newGradationName=this.row.gradation_name)}}),k=_,x=Object(d["a"])(k,C,b,!1,null,null,null),A=x.exports,$=function(){var t=this,e=this,n=e.$createElement,a=e._self._c||n;return a("div",[a("a-modal",{attrs:{title:"Добавляется сортировка для характеристики: "+this.row.name,visible:e.visible},on:{ok:e.handleOk,cancel:function(t){return e.$emit("onClose")}}},[a("div",[a("h3",[e._v("Выберете тип сортировки")]),a("a-button-group",[a("a-button",{on:{click:function(){return t.newArgument.value_type="range"}}},[e._v("Диапазон")]),a("a-button",{on:{click:function(){return t.newArgument.value_type="value"}}},[e._v("По одному значению")]),a("a-button",{on:{click:function(){return t.newArgument.value_type="boolean"}}},[e._v("По присутствию")])],1),"range"===this.newArgument.value_type?a("a-input-group",[a("p",[e._v("Если значение данной характеристики у продукта попадает в данный диапазон")]),a("a-form-item",{attrs:{label:"Название (показывается пользователю)"}},[a("a-input",{model:{value:e.newArgument.name,callback:function(t){e.$set(e.newArgument,"name",t)},expression:"newArgument.name"}})],1),a("a-form-item",{attrs:{label:"Значение ОТ"}},[a("a-input-number",{model:{value:e.newArgument.from,callback:function(t){e.$set(e.newArgument,"from",t)},expression:"newArgument.from"}})],1),a("a-form-item",{attrs:{label:"Значение ДО"}},[a("a-input-number",{model:{value:e.newArgument.to,callback:function(t){e.$set(e.newArgument,"to",t)},expression:"newArgument.to"}})],1)],1):e._e(),"value"===this.newArgument.value_type?a("a-input-group",[a("p",[e._v("Если имеются совпадения значения со свойством продукта в БД")]),a("a-form-item",{attrs:{label:"Название (показывается пользователю)"}},[a("a-input",{model:{value:e.newArgument.name,callback:function(t){e.$set(e.newArgument,"name",t)},expression:"newArgument.name"}})],1),a("a-form-item",{attrs:{label:"Значение (значение, с которым нужно искать совпадения в БД)"}},[a("a-input",{model:{value:e.newArgument.value,callback:function(t){e.$set(e.newArgument,"value",t)},expression:"newArgument.value"}})],1)],1):e._e(),"boolean"===this.newArgument.value_type?a("a-input-group",[a("p",[e._v("Если у продукта присутствует характеристика категории")]),a("a-form-item",{attrs:{label:"Название (Будет отображаться пользователю)"}},[a("a-input",{model:{value:e.newArgument.name,callback:function(t){e.$set(e.newArgument,"name",t)},expression:"newArgument.name"}})],1)],1):e._e()],1)])],1)},T=[],S={data:function(){return{newArgument:{value:"",value_type:"",name:"",from:null,to:null,category_id:null,category_property_id:null},type:"value"}},props:{row:{},visible:{}},methods:{openNotification:function(){this.$notification.open({message:"НЕ ВСЕ ПОЛЯ ФОРМЫ ЗАПОЛНЕНЫ",class:"bg-warning",description:"Поля должны быть заполнены, иначе возможны неисправности в фильтрации товаров пользователя."})},handleOk:function(){var t=this.newArgument;if(t.name.empty)this.openNotification();else{for(var e in t)switch(t.value_type){case"range":if(!t.from||!t.to)return void this.openNotification();break;case"value":if(t.value.empty)return void this.openNotification()}this.$store.dispatch("createSearchArgument",this.newArgument),this.$emit("onClose")}},handleCancel:function(){this.$emit("onClose")}},mounted:function(){this.newArgument.category_id=this.row.category_id,this.newArgument.category_property_id=this.row.id}},R=S,L=Object(d["a"])(R,$,T,!1,null,null,null),M=L.exports,B=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("a-upload-dragger",{attrs:{name:"category",multiple:!0,headers:{Authorization:"Bearer "+this.$store.state.user.api_token,Accept:"application/json"},action:"/api/admin/category"},on:{change:t.handleChange}},[n("p",{staticClass:"ant-upload-drag-icon"},[n("a-icon",{attrs:{type:"inbox"}})],1),n("p",{staticClass:"ant-upload-text"},[t._v(" Нажмите или перетащите сюда загружаемый файл ")])])},E=[],N={data:function(){return{}},methods:{handleChange:function(t){var e=t.file.status;"uploading"!==e&&console.log(t.file,t.fileList),"done"===e?(this.$message.success("".concat(t.file.name," file uploaded successfully.")),this.$store.dispatch("getAllCategories")):"error"===e&&this.$message.error("".concat(t.file.name," file upload failed."))}}},H=N,O=Object(d["a"])(H,B,E,!1,null,null,null),U=O.exports,V={computed:{data:function(){return this.$store.getters.allCategories}},components:{EditRowModal:A,CreateSearchArgument:M,UploadFile:U},methods:{deleteRow:function(t){var e=this;this.$confirm({title:"Удалить "+t.type+"?",okText:"Да",cancelText:"Нет",onOk:function(){var n=e.$message.loading("Пытаюсь удалить...",0);setTimeout(n,2500),e.$store.dispatch("deleteCategoryRow",t)}})},editRow:function(t){this.isEditAction=!0,this.curRow=t},addArgument:function(t){this.curRow=t,this.isCreateAction=!0}},data:function(){return{isEditAction:!1,isCreateAction:!1,curRow:{},projectHeaderBtns:"all",editActive:!1,columns:[{title:"ID",scopedSlots:{customRender:"category.id"}},{title:"НАЗВАНИЕ",scopedSlots:{customRender:"category.name"}},{title:"ТИП",scopedSlots:{customRender:"category.type"}},{title:"КОЛИЧЕСТВО ТОВАРОВ",scopedSlots:{customRender:"category.count"}},{title:"ВЗАИМОДЕЙСТВИЕ",scopedSlots:{customRender:"category.edit"},width:60}]}}},j=V,D=Object(d["a"])(j,w,y,!1,null,null,null),I=D.exports,Z=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div")},z=[],W={props:{visible:!0}},G=W,P=Object(d["a"])(G,Z,z,!1,null,"c3d3bd18",null),F=P.exports,J=[{title:"ФИО И EMAIL",dataIndex:"author",scopedSlots:{customRender:"author"}},{title:"СТАТУС АККАУНТА",dataIndex:"status",filters:[{text:"ПОДВЕРЖДЕНЫ",value:"true"},{text:"НЕ ПОДВЕРЖДЕНЫ",value:"false"}],onFilter:function(t,e){return"true"===t?e.status:!e.status},width:20,scopedSlots:{customRender:"status"}},{title:"РЕГИСТРАЦИЯ",dataIndex:"employed",class:"text-muted"},{title:"ВЗАИМОДЕЙСТВИЕ",scopedSlots:{customRender:"editBtn"},width:60}],K=[{key:123,id:123,name:"name",children:[{key:1,id:23,name:"propName1"},{key:2,id:24,name:"propName2"}]}],q={components:{CardAuthorTable:v,CardCategoriesTable:I,Preloader:F},methods:{onDeleteInUsers:function(t){var e=this.table1Data[t];this.$store.dispatch("deleteUser",e.id)},changeUserStatus:function(t){var e=this.table1Data[t];this.$store.dispatch("changeUserStatus",e.id)},sortTableByRole:function(t){this.sortArguments.string=t,this.sortArguments.type="role"},searchInUsers:function(t){this.sortArguments.string=t,this.sortArguments.type="search"}},computed:{loading:function(){return this.$store.getters.loading},table1Data:function(){return this.$store.getters.searchInUsers(this.sortArguments.type,this.sortArguments.string)}},data:function(){return{sortArguments:{type:"role",string:"all"},table1Columns:J,table2Data:K}}},Q=q,X=Object(d["a"])(Q,a,s,!1,null,null,null);e["default"]=X.exports}}]);
//# sourceMappingURL=chunk-74afe032.91146cf7.js.map